(function(e){typeof define=="function"&&define.amd?define(e):e()})(function(){"use strict";function n(e,t,n,s,o,i,a){try{var r=e[i](a),c=r.value}catch(e){return void n(e)}r.done?t(c):Promise.resolve(c).then(s,o)}function s(e){return function(){var t=this,s=arguments;return new Promise(function(o,i){var r=e.apply(t,s);function a(e){n(r,o,i,a,c,"next",e)}function c(e){n(r,o,i,a,c,"throw",e)}a(void 0)})}}function i(e,t,n){return(t=r(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n,s=Object.keys(e);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(e),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,n)),s}function t(e){for(var t,n=1;n<arguments.length;n++)t=arguments[n]!=null?arguments[n]:{},n%2?o(Object(t),!0).forEach(function(n){i(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))});return e}function e(){e=function(){return t};var o,a,c,u,h,t={},k=Object.prototype,r=k.hasOwnProperty,p=Object.defineProperty||function(e,t,n){e[t]=n.value},y=typeof Symbol=="function"?Symbol:{},m=y.iterator||"@@iterator",T=y.asyncIterator||"@@asyncIterator",g=y.toStringTag||"@@toStringTag";function n(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{n({},"")}catch{n=function(e,t,n){return e[t]=n}}function x(e,t,n,s){var i=t&&t.prototype instanceof b?t:b,o=Object.create(i.prototype),a=new j(s||[]);return p(o,"_invoke",{value:M(e,n,a)}),o}function _(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=x;var E="suspendedStart",F="suspendedYield",O="executing",l="completed",s={};function b(){}function f(){}function i(){}h={},n(h,m,function(){return this}),u=Object.getPrototypeOf,c=u&&u(u(w([]))),c&&c!==k&&r.call(c,m)&&(h=c),a=i.prototype=b.prototype=Object.create(h);function C(e){["next","throw","return"].forEach(function(t){n(e,t,function(e){return this._invoke(t,e)})})}function d(e,t){function n(s,o,i,a){if(l=_(e[s],e,o),l.type!=="throw"){var l,d=l.arg,c=d.value;return c&&typeof c=="object"&&r.call(c,"__await")?t.resolve(c.__await).then(function(e){n("next",e,i,a)},function(e){n("throw",e,i,a)}):t.resolve(c).then(function(e){d.value=e,i(d)},function(e){return n("throw",e,i,a)})}a(l.arg)}var s;p(this,"_invoke",{value:function(e,o){function i(){return new t(function(t,s){n(e,o,t,s)})}return s=s?s.then(i,i):i()}})}function M(e,t,n){var i=E;return function(a,r){if(i===O)throw Error("Generator is already running");if(i===l){if(a==="throw")throw r;return{value:o,done:!0}}for(n.method=a,n.arg=r;;){var c,d,u=n.delegate;if(u&&(d=A(u,n),d)){if(d===s)continue;return d}if(n.method==="next")n.sent=n._sent=n.arg;else if(n.method==="throw"){if(i===E)throw i=l,n.arg;n.dispatchException(n.arg)}else n.method==="return"&&n.abrupt("return",n.arg);if(i=O,c=_(e,t,n),c.type==="normal"){if(i=n.done?l:F,c.arg===s)continue;return{value:c.arg,done:n.done}}c.type==="throw"&&(i=l,n.method="throw",n.arg=c.arg)}}}function A(e,t){var n,a,i=t.method,r=e.iterator[i];return r===o?(t.delegate=null,i==="throw"&&e.iterator.return&&(t.method="return",t.arg=o,A(e,t),t.method==="throw")||i!=="return"&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+i+"' method")),s):(a=_(r,e.iterator,t.arg),a.type==="throw"?(t.method="throw",t.arg=a.arg,t.delegate=null,s):(n=a.arg,n?n.done?(t[e.resultName]=n.value,t.next=e.nextLoc,t.method!=="return"&&(t.method="next",t.arg=o),t.delegate=null,s):n:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,s)))}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function v(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function j(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function w(e){if(e||e===""){if(t=e[m],t)return t.call(e);if(typeof e.next=="function")return e;if(!isNaN(e.length)){var t,n=-1,s=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=o,t.done=!0,t};return s.next=s}}throw new TypeError(typeof e+" is not iterable")}return f.prototype=i,p(a,"constructor",{value:i,configurable:!0}),p(i,"constructor",{value:f,configurable:!0}),f.displayName=n(i,g,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t=typeof e=="function"&&e.constructor;return!!t&&(t===f||(t.displayName||t.name)==="GeneratorFunction")},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,i):(e.__proto__=i,n(e,g,"GeneratorFunction")),e.prototype=Object.create(a),e},t.awrap=function(e){return{__await:e}},C(d.prototype),n(d.prototype,T,function(){return this}),t.AsyncIterator=d,t.async=function(e,n,s,o,i){i===void 0&&(i=Promise);var a=new d(x(e,n,s,o),i);return t.isGeneratorFunction(n)?a:a.next().then(function(e){return e.done?e.value:a.next()})},C(a),n(a,g,"Generator"),n(a,m,function(){return this}),n(a,"toString",function(){return"[object Generator]"}),t.keys=function(e){var s,n=Object(e),t=[];for(s in n)t.push(s);return t.reverse(),function e(){for(;t.length;){var s=t.pop();if(s in n)return e.value=s,e.done=!1,e}return e.done=!0,e}},t.values=w,j.prototype={constructor:j,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=o,this.done=!1,this.delegate=null,this.method="next",this.arg=o,this.tryEntries.forEach(v),!e)for(var t in this)t.charAt(0)==="t"&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=o)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if(e.type==="throw")throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;s=this;function n(t,n){return l.type="throw",l.arg=e,s.next=t,n&&(s.method="next",s.arg=o),!!n}for(i=this.tryEntries.length-1;i>=0;--i){var s,i,a,c,t=this.tryEntries[i],l=t.completion;if(t.tryLoc==="root")return n("end");if(t.tryLoc<=this.prev)if(a=r.call(t,"catchLoc"),c=r.call(t,"finallyLoc"),a&&c){{if(this.prev<t.catchLoc)return n(t.catchLoc,!0);if(this.prev<t.finallyLoc)return n(t.finallyLoc)}}else if(a){if(this.prev<t.catchLoc)return n(t.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<t.finallyLoc)return n(t.finallyLoc)}}},abrupt:function(e,t){for(var n,o,i,a=this.tryEntries.length-1;a>=0;--a)if(o=this.tryEntries[a],o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){n=o;break}return n&&(e==="break"||e==="continue")&&n.tryLoc<=t&&t<=n.finallyLoc&&(n=null),i=n?n.completion:{},i.type=e,i.arg=t,n?(this.method="next",this.next=n.finallyLoc,s):this.complete(i)},complete:function(e,t){if(e.type==="throw")throw e.arg;return e.type==="break"||e.type==="continue"?this.next=e.arg:e.type==="return"?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):e.type==="normal"&&t&&(this.next=t),s},finish:function(e){for(var t,n=this.tryEntries.length-1;n>=0;--n)if(t=this.tryEntries[n],t.finallyLoc===e)return this.complete(t.completion,t.afterLoc),v(t),s},catch:function(e){for(var t,s,o,n=this.tryEntries.length-1;n>=0;--n)if(t=this.tryEntries[n],t.tryLoc===e)return s=t.completion,s.type==="throw"&&(o=s.arg,v(t)),o;throw Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:w(e),resultName:t,nextLoc:n},this.method==="next"&&(this.arg=o),s}},t}function a(e,t){if(typeof e!="object"||!e)return e;var n,s=e[Symbol.toPrimitive];if(s!==void 0){if(n=s.call(e,t||"default"),typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function r(e){var t=a(e,"string");return typeof t=="symbol"?t:t+""}(function(n){var i=function(e){var s=e.serializeArray(),t={};return n.map(s,function(e){t[e.name]=e.value}),t},o=function(e){var t,n,s;for(n in e.user)!e.user[n]&&delete e.user[n];if((t=e.user)!==null&&t!==void 0&&t.attributes)for(s in e.user.attributes)!e.user.attributes[s]&&delete e.user.attributes[s];return e},a=function(e,n){var a,r,c,l,d,u,h,m,f,p,g,v,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"",b=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"",s={},i="".concat((v=n.firstName)!==null&&v!==void 0?v:""," ").concat((g=n.lastName)!==null&&g!==void 0?g:"");switch(e){case"ACTIVE_CAMPAIGN":s={provider:"ACTIVE_CAMPAIGN",user:{email:n.email,firstName:(p=n.firstName)!==null&&p!==void 0?p:"",lastName:(u=n.lastName)!==null&&u!==void 0?u:"",listId:o}};break;case"EMAIL_OCTOPUS":s={provider:"EMAIL_OCTOPUS",user:{email:n.email,name:i,listId:o}};break;case"SEND_IN_BLUE":s={provider:"SEND_IN_BLUE",user:{email:n.email,listId:Number(o),attributes:{FIRSTNAME:(r=n.firstName)!==null&&r!==void 0?r:"",LASTNAME:(c=n.lastName)!==null&&c!==void 0?c:""}}};break;case"MAIL_CHIMP":s={provider:"MAIL_CHIMP",user:t(t({},n),{},{listId:o})};break;case"CONVERT_KIT":s={provider:"CONVERT_KIT",user:{formId:o,email:n.email,firstName:(l=n.firstName)!==null&&l!==void 0?l:"",lastName:(d=n.lastName)!==null&&d!==void 0?d:""}};break;case"MAILER_LITE":s={provider:"MAILER_LITE",user:{email:n.email,name:(a=n.firstName)!==null&&a!==void 0?a:"",lastName:(h=n.lastName)!==null&&h!==void 0?h:"",groupId:o}};break;case"MAIL_JET":s={provider:"MAIL_JET",user:{listId:o,email:n.email,name:i}};break;case"LEM_LIST":s={provider:"LEM_LIST",user:t(t({},n),{},{campaignId:o})};break;case"MOO_SEND":s={provider:"MOO_SEND",user:{mailingListId:o,email:n.email,name:i}};break;case"SEND_FOX":s={provider:"SEND_FOX",user:{listId:o,email:n.email,firstName:(m=n.firstName)!==null&&m!==void 0?m:"",lastName:(f=n.lastName)!==null&&f!==void 0?f:""}};break;case"BIG_MAILER":s={provider:"BIG_MAILER",user:{brandId:b,listId:o,email:n.email}};break;case"GET_RESPONSE":s={provider:"GET_RESPONSE",user:{campaignId:o,email:n.email,name:i}};break;case"HUB_SPOT":s={provider:"HUB_SPOT",user:{email:n.email,listId:o}};break;case"MAILER_CLOUD":s={provider:"MAILER_CLOUD",user:{email:n.email,list_id:o}};break}return s},r=function(){var t=s(e().mark(function t(n){var s,i,r,c,l,d,u,h,m,f,p;return e().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s=n.service,i=n.formData,r=n.siteId,c=n.brandId,l=n.keyId,d=n.listId,u=n.subscriptionApiURL,h=JSON.stringify(o(a(s,i,d,c))),m=new Headers({"x-project-id":r,"x-key-id":l}),e.next=5,fetch(u,{method:"POST",headers:m,body:o(h)});case 5:return f=e.sent,e.next=8,f.json();case 8:return p=e.sent,e.abrupt("return",p);case 10:case"end":return e.stop()}},t)}));return function(){return t.apply(this,arguments)}}();n.fn.Subscribe=function(t){var l=t.siteId,m=t.keyId,a=t.service,d=t.listId,g=t.brandId,u=t.successAction,h=t.successMessage,c=t.rootEl,f=t.verifyLegitimateUser,p=t.subscriptionApiURL,o=n(this);o.on("submit",function(){var t=s(e().mark(function t(s){var v,b,j,y,_,w,O,x,C,E;return e().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(s.preventDefault(),C=f(o.attr("id")),C){e.next=4;break}return e.abrupt("return");case 4:return O=document.querySelectorAll("".concat(c," button .loader"))[0],O.classList.remove("hidden"),o.find(".success-message").remove(),o.find(".error-message").remove(),w=i(o),e.next=11,r({service:a,formData:w,siteId:l,brandId:g,keyId:m,listId:d,subscriptionApiURL:p});case 11:y=e.sent,y.response&&(O.classList.add("hidden"),_="",v="",y.response.success?(_="success-message",v=h,o.trigger("reset")):(j=y.response.body[0],_="error-message",a==="LEM_LIST"||a==="SEND_IN_BLUE"||a==="MAIL_JET"?j.search("already")&&(v="Contact already exist."):a==="GET_RESPONSE"?v=j.message:a==="MAIL_CHIMP"?v=j.replace("Use PUT to insert or update list members.",""):v="Something went wrong."),u==="forward"?(b=document.querySelector(c).querySelector(".forward--url").dataset.forwardTo,x=/{{(.*?)}}/g,x.test(b)&&(b=b.replace(x,function(e,t){var n;return(n=w[t.trim()])!==null&&n!==void 0?n:""})),window.location.href=b):(E=n("<div>",{class:_,html:v}),o.append(E)));case 13:case"end":return e.stop()}},t)}));return function(){return t.apply(this,arguments)}}())}})(jQuery)})